
{{define "main.style"}}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.3.5/cropper.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.10.0/css/lightbox.min.css">
{{end}}

{{define "main.script"}}
<script async src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.3.5/cropper.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.0/sweetalert.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.10.0/js/lightbox.min.js"></script>


<script>
new Vue({
	el: '#app',
	data() {
		return {
			coin: 20,
			postBetURL: '',
			isLoading: false,
			addx3: false,
			addx10: false,
			phow1: false,
			phow2: false,
			phow3: false,
			yingchob: 0,
			hammer1: false,
			scissors1: false,
			paper1: false,
			hammer3: false,
			scissors3: false,
			paper3: false,
			hammer10: false,
			scissors10: false,
			paper10: false,
			choosephow1: 3,
			choosephow2: 3,
			choosephow3: 3,
			choosephow: [],
			yingchobBot1: 3,
			yingchobBot2: 3,
			yingchobBot3: 3,
			isLoading: false,
			buttonChange: 0,
		}
	},

	mounted() {

	},

	computed: {

	},

	methods: {
		playGame() {
			if(this.phow1 === true) {
				this.choosephow = []
				if(this.choosephow1 < 3) {
					//checkphow2
					if(this.phow2 === true) {
						if(this.choosephow2 < 3) {
							//checkphow 3
							if(this.phow3 === true) {
								if(this.choosephow3 < 3) {
									console.log('ส่งสามเป้า')
									this.ajaxYingchob(3)
								} else if(this.choosephow3 === 3) {
									alert('กรุณาเลือกเป้าที่สาม')
								}
							} else {
								console.log('ส่งสองเป้า')
								this.ajaxYingchob(2)
							}
						} else if(this.choosephow2 === 3) {
							alert('กรุณาเลือกเป้าที่สอง')
						}
					} else {
						//เป้าแรก
						this.ajaxYingchob(1)
					}
				}
			} else if (this.phow1 === false) {
				alert('กรุณาเลือกเป้าแรก')
			}
		},
		ajaxYingchob(val){
			this.isLoading = true
			this.yingchobBot1 = 3
			this.yingchobBot2 = 3
			this.yingchobBot3 = 3
			$('.betwin').hide('show')
			$('.betlose').hide('show')
			$('.refill').hide('show')
			$('.draw').hide('show')
			$('.phow1').removeClass('ying-chob-win')
			$('.phow1').removeClass('ying-chob-lose')
			$('.phow1').addClass('ying-chob-1')
			$('.phow2').removeClass('ying-chob-win')
			$('.phow2').removeClass('ying-chob-lose')
			$('.phow2').addClass('ying-chob-1')
			$('.phow3').removeClass('ying-chob-win')
			$('.phow3').removeClass('ying-chob-lose')
			$('.phow3').addClass('ying-chob-1')
			if(val === 1) {
				this.yingchob = 1
				this.choosephow.push(this.choosephow1)
			} else if (val === 2) {
				this.yingchob = 2
				this.choosephow.push(this.choosephow1, this.choosephow2)
			} else if (val === 3){
				this.yingchob = 3
				this.choosephow.push(this.choosephow1, this.choosephow2, this.choosephow3)
			}
			axios.post('/ajax/yingchob/bet', {
			yingchob: this.choosephow,
			price: this.coin,
			number: this.yingchob
			}, { withCredentials: true }).then(res => {
				console.log(res.data)
				if(res.status === 200) {
					if (res.data.noMoney) {
						$('.refill').addClass('show')
						$('.refill').show('show')
						window.location.href = "https://www.richboxclub.com/wallet";
					} else {
						res.data.yingchob.forEach((data, index)  => {
							setTimeout(() => {
								if(index === 0) {
									this.yingchobBot1 = res.data.yingchob[index].yingchob_bot
									if(res.data.yingchob[index].status === 0) {
										$('.phow1').removeClass('ying-chob-1')
										$('.phow1').addClass('ying-chob-lose')
									} else if (res.data.yingchob[index].status === 1) {
										$('.phow1').removeClass('ying-chob-1')
										$('.phow1').addClass('ying-chob-win')
									}
								}
								if(index === 1) {
									this.yingchobBot2 = res.data.yingchob[index].yingchob_bot
									if(res.data.yingchob[index].status === 0) {
										$('.phow2').removeClass('ying-chob-1')
										$('.phow2').addClass('ying-chob-lose')
									} else if (res.data.yingchob[index].status === 1) {
										$('.phow2').removeClass('ying-chob-1')
										$('.phow2').addClass('ying-chob-win')
									}
								}
								if(index === 2) {
									this.yingchobBot3 = res.data.yingchob[index].yingchob_bot
									if(res.data.yingchob[index].status === 0) {
										$('.phow3').removeClass('ying-chob-1')
										$('.phow3').addClass('ying-chob-lose')
									} else if (res.data.yingchob[index].status === 1) {
										$('.phow3').removeClass('ying-chob-1')
										$('.phow3').addClass('ying-chob-win')
									}
								}
								if(this.yingchob - 1 === index) {
									if(res.data.status === 1) {
										$('.betwin').addClass('show')
										$('.betwin').show('show')
										$('.textwin').text("ได้รับเงินจำนวน " + res.data.price + " THB")
									}

									this.isLoading = false
									$('.wallet').text(res.data.wallet +" THB")
									$('.bonus').text(res.data.bonus +" THB")
								}
							},index * 1200)
						})
					}
				}
			}).catch(error => {

			})
		},
		changeCoin(c, type, finalfrontback) {
			$('.betwin').removeClass('show')
			$('.betlose').removeClass('show')
			$('.refill').removeClass('show')
			if(this.isLoading) return

			if (type === "coin" && c > 0) {
				this.showFrontback = ""
				this.coin = c
				this.isCoin = c

			} else if (type === "bet" && this.isCoin > 0 && this.coin > 0) {
				this.showFrontback = ""
				this.isLoading = true

				axios.post('/ajax/frontback/bet', {
					frontback: finalfrontback,
					price: this.coin
					}, { withCredentials: true }).then(res => {
						console.log(res.data.noMoney)
						if (res.data.noMoney) {
							$('.refill').addClass('show')
							this.coin = 0
							this.isCoin = 0
							this.isLoading = false
							window.location.href = "https://www.richboxclub.com/wallet";
						} else {
							this.showFrontback = res.data.frontback
								setTimeout(() => {
									if(finalfrontback === res.data.frontback) {
										$('.betwin').addClass('show')
										$('.textwin').text("ได้รับเงินจำนวน " + res.data.price + " THB")

									} else {
										$('.betlose').addClass('show')
									}
									this.isLoading = false
									$('.wallet').text(res.data.wallet +" THB")
									$('.bonus').text(res.data.bonus +" THB")
									$('.btn-transparent').attr("disabled", false)
							},7000);
						}
					}).catch(error => {

					})
			}
		},
		openX(val){
			if (val === 3) {

				if(this.addx10 === true) {
					this.addx10 = !this.addx10
					this.phow3 = !this.phow3
					this.choosephow3 = 3
					this.buttonChange = 1
				} else if (this.buttonChange === 1) {
					this.addx3 = !this.addx3
					this.phow2 = !this.phow2
					this.choosephow2 = 3
					this.buttonChange = 0
				} else {
					this.addx3 = !this.addx3
					this.phow2 = !this.phow2
					this.choosephow2 = 3
					this.buttonChange = 1
				}
			} else if (val === 10){
				if(this.addx3 === false) {
					this.addx3 = !this.addx3
					this.addx10 = !this.addx10
					this.phow2 = !this.phow2
					this.phow3 = !this.phow3
					this.choosephow2 = 3
					this.choosephow3 = 3
					this.buttonChange = 2
				} else if (this.buttonChange === 2) {
					this.addx10 = !this.addx10
					this.phow3 = !this.phow3
					this.choosephow3 = 3
					this.buttonChange = 1
				} else {
					this.addx10 = !this.addx10
					this.phow3 = !this.phow3
					this.choosephow3 = 3
					this.buttonChange = 2
				}
			} else {
				this.addx3 = false
				this.addx10 = false
				this.phow2 = false
				this.phow3 = false
				this.phow1 = false
				this.choosephow1 = 3
				this.choosephow2 = 3
				this.choosephow3 = 3
				this.buttonChange = 0
			}
		},
		selectYingchob1(val) {
			if(val === 'hammer'){
				this.choosephow1 = 0
				this.phow1 = true

			} else if (val === 'scissors') {
				this.choosephow1 = 1
				this.phow1 = true

			} else if (val === 'paper') {
				this.choosephow1 = 2
				this.phow1 = true

			}
		},
		selectYingchob3(val) {
			if(val === 'hammer'){
				this.choosephow2 = 0
				this.phow2 = true

			} else if (val === 'scissors') {
				this.choosephow2 = 1
				this.phow2 = true

			} else if (val === 'paper') {
				this.choosephow2 = 2
				this.phow2 = true

			}
		},
		selectYingchob10(val) {
			if(val === 'hammer'){
				this.choosephow3 = 0
				this.phow3 = true
			} else if (val === 'scissors') {
				this.choosephow3 = 1
				this.phow3 = true
			} else if (val === 'paper') {
				this.choosephow3 = 2
				this.phow3 = true
			}
		},
		openModal() {
			$('#modal-select-money').modal({
				keyboard: false,
				backdrop: 'static'
			})
		},
		openModalHowToPlay(){
			$('#modal-how-to-play').modal('show')
		},
		closeModal() {
			$('#modal-select-money').modal('hide')
		},
		closeModalHowToPlay() {
			$('#modal-how-to-play').modal('hide')
		},
		selectCoin(price) {
			this.coin = price
		},
		submitMoney(){
			if(this.coin === 0) {
				return
			} else if (this.coin > 0){
				$('#modal-select-money').modal('hide')
			} else {
				alert('กรุณาเลือกจำนวนเงิน')
			}
		},
		closeAlertbet() {
			$('.betwin').hide()
			$('.betlose').hide()
			$('.refill').hide()
		}

	}
}) // end upload
</script>
{{end}}
